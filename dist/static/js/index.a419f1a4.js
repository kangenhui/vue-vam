(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["index"],{0:function(e,t,n){e.exports=n("b635")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"9c0c":function(e,t,n){},b635:function(e,t,n){"use strict";n.r(t);n("7f7f");var a=n("2b0e"),r=n("c035"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app",attrs:{id:"app"}},[n("router-view")],1)},i=[],s={name:"App"},c=s,u=(n("5c0b"),n("2877")),d=Object(u["a"])(c,o,i,!1,null,null,null),p=d.exports,l=n("5c96"),h=n.n(l),m=(n("0fae"),n("8c4f"));a["default"].use(m["a"]);var f=[{path:"/",component:function(){return n.e("chunk-462a9815").then(n.bind(null,"1dae"))},name:"main",props:!0},{path:"/photograph",component:function(){return Promise.all([n.e("chunk-0b759c92"),n.e("chunk-4d827818")]).then(n.bind(null,"e795"))},name:"photograph",props:!0},{path:"/videoRecording",component:function(){return Promise.all([n.e("chunk-0b759c92"),n.e("chunk-63d4202b")]).then(n.bind(null,"7e31"))},name:"videoRecording",props:!0},{path:"/demo2",component:function(){return n.e("chunk-37867dac").then(n.bind(null,"1d74"))},name:"demo2",props:!0},{path:"/demo3",component:function(){return n.e("chunk-c9ed2980").then(n.bind(null,"110e"))},name:"demo3",props:!0},{path:"/cameraCanvas",component:function(){return n.e("chunk-475326cc").then(n.bind(null,"690a"))},name:"cameraCanvas",props:!0}],v=new m["a"]({routes:f}),g=v,b=function e(t){e.installed||t.component(r["a"].name,r["a"])},w={WebCam:r["a"],install:b};a["default"].use(w),a["default"].use(h.a),new a["default"]({el:"#app",router:g,render:function(e){return e(p)}})},c035:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"webcam"},[n("video",{ref:"video",attrs:{width:e.width,height:e.height,src:e.source,autoplay:e.autoplay,playsinline:e.playsinline,muted:""},domProps:{muted:!0}})])},r=[],o=(n("456d"),n("8a81"),n("d25f"),n("9986"),n("8e6e"),n("c973")),i=n.n(o),s=n("9523"),c=n.n(s),u=n("a34a"),d=n.n(u),p=(n("c5f6"),n("a481"),n("06db"),n("551c"),n("bc3a")),l=n.n(p),h=n("294d"),m=n.n(h);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){c()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={name:"vue-cam-vision",data:function(){return{source:null,canvas:null,camerasListEmitted:!1,cameras:[],imageCapture:{},captures:[],imgReport:null,lastVideoMode:"deviceId",camsList:{back:null,front:null},inited:!1,recordedBlobs:[]}},props:{width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:"400"},autoplay:{type:Boolean,default:!0},screenshotFormat:{type:String,default:"image/jpeg"},deviceId:{type:String,default:null},playsinline:{type:Boolean,default:!0},mediaConstraints:{type:Object,default:function(){return{video:!0,audio:!1}}},isFrontCam:{type:Boolean,default:!0},maxSnapshot:{type:[Number],default:3},googleKey:{type:String,default:null},debug:{type:Boolean,default:!1}},watch:{deviceId:function(e,t){e!==t&&this.changeCamera(e)},isFrontCam:function(e,t){e!==t&&this.changeFrontBack(e)},captures:function(e){this.$emit("capturedImages",e)}},computed:{supportFacingMode:function(){var e="";return e=navigator.mediaDevices.getSupportedConstraints()["facingMode"]?"Supported!":"Not supported!",e},Contraints:function(){var e=this.mediaConstraints.video.facingMode||(this.isFrontCam?"user":"environment"),t=v(v(v({},this.mediaConstraints.video),this.deviceId?{deviceId:{exact:this.deviceId}}:{}),{},{facingMode:e,width:300,height:150});return{video:t,audio:this.mediaConstraints.audio}}},mounted:function(){this.setup()},methods:{loadSrcStream:function(e){var t=this;if("srcObject"in this.$refs.video)try{this.$refs.video.srcObject=e}catch(n){console.log("err==>",n)}else this.source=window.HTMLMediaElement.srcObject(e);this.video.onloadedmetadata=function(){t.video.play()},this.video.play(),this.$emit("started",e)},changeCamera:function(e){this.stop(),this.$emit("camera-change",e),this.deviceId=e,this.loadCamera()},loadCameras:function(){var e=this;return i()(d.a.mark((function t(){var n;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.enumerateDevices();case 3:n=t.sent,e.debug&&console.log(n),n.forEach((function(t){"videoinput"===t.kind&&(e.cameras.push(t),-1!==t.label.toLowerCase().indexOf("back")&&(e.camsList.back=t),-1!==t.label.toLowerCase().indexOf("front")&&(e.camsList.front=t))})),e.camerasListEmitted||(e.$emit("cameras",e.cameras),e.camerasListEmitted=!0),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$emit("notsupported",t.t0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},stopStreamedVideo:function(e){var t=this,n=e.srcObject,a=n.getTracks();a.forEach((function(e){e.stop(),t.$emit("stopped",n),t.$refs.video.srcObject=null,t.source=null}))},stop:function(){null!==this.$refs.video&&this.$refs.video.srcObject&&(this.debug&&console.log("stoping"),this.stopStreamedVideo(this.$refs.video))},setup:function(){var e=this;return i()(d.a.mark((function t(){return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadCameras();case 2:e.start();case 3:case"end":return t.stop()}}),t)})))()},start:function(){this.loadCamera()},isMobile:function(){return"undefined"!==typeof window.orientation},toggleFrontBack:function(){this.isFrontCam=!this.isFrontCam},changeFrontBack:function(e){e&&this.camsList.front&&this.changeCamera(this.camsList.front.deviceId),!e&&this.camsList.back&&this.changeCamera(this.camsList.back.deviceId)},loadCamera:function(){var e=this;this.debug&&console.log(this.Contraints),m()(this.Contraints,(function(t,n){if(t)return e.$emit("error",t),void console.log("failed to get user camera");if(console.log("Got stream",n),window.ImageCapture){var a=n.getVideoTracks()[0];e.imageCapture=new ImageCapture(a)}e.video=e.$refs.video,e.loadSrcStream(n)}))},capture:function(){var e=this;return i()(d.a.mark((function t(){var n;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.canvas=e.getCanvas(),n=e.canvas.toDataURL(e.screenshotFormat,.7),n.replace("data:image/jpeg;base64,",""),e.saveSnapShot(n),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()},saveSnapShot:function(e){return this.captures.length>this.maxSnapshot&&this.captures.shift(),this.captures.push({image:e,imgReport:{}}),this.debug&&console.log("saved SnapShot"),e},gCapture:function(){var e=this;return i()(d.a.mark((function t(){var n,a,r;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imageCapture.takePhoto();case 2:return n=t.sent,a=new FileReader,r=null,t.abrupt("return",new Promise((function(t,o){a.onerror=function(e){console.error(e),a.abort(),o()},a.onloadend=function(){r=a.result,e.saveSnapShot(r),e.debug&&console.log(r),t(r)},a.readAsDataURL(n)})));case 6:case"end":return t.stop()}}),t)})))()},getCanvas:function(){var e=this.$refs.video;if(!this.ctx){var t=document.createElement("canvas");t.height=e.videoHeight,t.width=e.videoWidth,this.canvas=t,this.ctx=t.getContext("2d")}var n=this.ctx,a=this.canvas;return n.drawImage(e,0,0,a.width,a.height),a},googleVision:function(){var e=arguments,t=this;return i()(d.a.mark((function n(){var a,r,o,i,s,c,u;return d.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.length>0&&void 0!==e[0]?e[0]:"LABEL_DETECTION",r=e.length>1?e[1]:void 0,t.googleKey){n.next=4;break}return n.abrupt("return");case 4:return o="https://vision.googleapis.com/v1/images:annotate?key=".concat(t.googleKey),i=r,r&&"undefined"!==typeof r||(i=t.captures.length-1),s={requests:[{image:{content:t.captures[i].image.replace("data:image/jpeg;base64,","")},features:{type:a}}]},n.next=10,l.a.post(o,s);case 10:return c=n.sent,u=c.data,u&&u.responses[0]&&(t.imgReport=u.responses[0],t.captures[i].imgReport=u.responses[0]),t.$emit("googleReport",t.imgReport),n.abrupt("return",t.imgReport);case 15:case"end":return n.stop()}}),n)})))()},record:function(){var e=this;return i()(d.a.mark((function t(){var n,a;return d.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.recordedBlobs=[],"function"===typeof MediaRecorder.isTypeSupported?(MediaRecorder.isTypeSupported("video/webm;codecs=vp9")||MediaRecorder.isTypeSupported("video/webm;codecs=h264")?n={MimeType:"video/webm;codecs=h264"}:MediaRecorder.isTypeSupported("video/webm;codecs=vp8")&&(n={MimeType:"video/webm;codecs=vp8"}),a=new MediaRecorder(e.$refs.video.srcObject,n)):a=new MediaRecorder(e.$refs.video.srcObject),a.start(),a.ondataavailable=function(t){t.data&&t.data.size>0&&e.recordedBlobs.push(t.data)},a.onstop=function(){console.log("停止录制事件");new FileReader,new Blob(e.recordedBlobs,{type:"video/mp4"})};case 5:case"end":return t.stop()}}),t)})))()},stopVideo:function(){if(console.log(this.$refs.video.srcObject),this.$refs.video.srcObject){var e=this.$refs.video.srcObject,t=e.getTracks();t.forEach((function(e){e.stop()}))}}}},b=g,w=n("2877"),y=Object(w["a"])(b,a,r,!1,null,null,null);t["a"]=y.exports}},[[0,"runtime","chunk-elementUI","chunk-libs"]]]);